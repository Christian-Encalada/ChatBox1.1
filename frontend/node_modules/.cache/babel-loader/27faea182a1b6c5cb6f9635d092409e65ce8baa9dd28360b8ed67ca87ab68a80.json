{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Chris\\\\Desktop\\\\ChatBox\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n/* global firebase */\n\nimport './App.css';\nimport { io } from 'socket.io-client';\nimport { useState, useEffect } from 'react';\nimport { LiMensaje, UlMensajes } from './ui-components';\nimport { getMessaging, getToken, onMessage } from \"firebase/messaging\";\nimport { initializeApp } from 'firebase/app';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBwBEW-vmdytwra50NwyHaQhYCqg4s_yV4\",\n  authDomain: \"chatbox-98fbb.firebaseapp.com\",\n  projectId: \"chatbox-98fbb\",\n  storageBucket: \"chatbox-98fbb.appspot.com\",\n  messagingSenderId: \"314247152483\",\n  appId: \"1:314247152483:web:ad1e17c335f01bb6da4956\"\n};\nconst firebaseApp = initializeApp(firebaseConfig);\nconst messaging = getMessaging(firebaseApp);\n\n// Solicitar permiso de notificación al cargar la aplicación\nNotification.requestPermission().then(permission => {\n  if (permission === 'granted') {\n    console.log('Permiso de notificación concedido');\n    return getToken(messaging, {\n      vapidKey: '3gjp1GuVkYSZPPsz04fzhOjIoE0PYUYccu3zRlxmMMQ'\n    });\n  } else {\n    throw new Error('Permiso de notificación denegado');\n  }\n}).then(currentToken => {\n  if (currentToken) {\n    // Send the token to your server and update the UI if necessary\n    console.log('Token FCM:', currentToken);\n  } else {\n    console.log('No registration token available. Request permission to generate one.');\n  }\n}).catch(err => {\n  console.error('An error occurred while retrieving token. ', err);\n});\n\n// Manejar las notificaciones entrantes\nonMessage(messaging, payload => {\n  console.log('Notificación recibida:', payload);\n\n  // Mostrar una notificación emergente\n  const notification = new Notification('Nuevo mensaje', {\n    body: `${payload.data.usuario}: ${payload.data.mensaje}`\n  });\n\n  // Agregar un sonido de frecuencia grave\n  const audio = new Audio('C:\\Users\\Chris\\Desktop\\ChatBox\\frontend\\sonido\\sonidob.mp3'); // Sustituye <URL_DEL_SONIDO> por la URL del archivo de sonido\n  audio.play();\n\n  // Puedes agregar más lógica aquí según tus necesidades\n});\n\nconst socket = io('http://localhost:3000');\nfunction App() {\n  _s();\n  const [isConnected, setIsConnected] = useState(false);\n  const [nuevoMensaje, setNuevoMensaje] = useState('');\n  const [nombreUsuario, setNombreUsuario] = useState('');\n  const [mensajes, setMensajes] = useState([]);\n  useEffect(() => {\n    socket.on('connectado', () => setIsConnected(true));\n    socket.on('enviar_mensaje', data => {\n      setMensajes(mensajes => [...mensajes, data]);\n    });\n    return () => {\n      socket.off('connectado');\n      socket.off('enviar_mensaje');\n    };\n  }, []);\n  const enviarMensaje = () => {\n    socket.emit('enviar_mensaje', {\n      usuario: nombreUsuario,\n      mensaje: nuevoMensaje\n    });\n\n    // Enviar notificación usando FCM\n    messaging.getToken().then(token => {\n      const message = {\n        notification: {\n          title: 'Nuevo Mensaje',\n          body: `${nombreUsuario}: ${nuevoMensaje}`\n        },\n        token: token\n      };\n      return firebase.messaging().send(message);\n    }).catch(error => {\n      console.error('Error al enviar la notificación:', error);\n    });\n  };\n  const unirseAlChat = () => {\n    // Cuando el usuario se une al chat, envía su nombre al servidor\n    socket.emit('unirse_al_chat', nombreUsuario);\n    setIsConnected(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: isConnected ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"SI ESTAS CONECTADO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(UlMensajes, {\n        children: mensajes.map((mensaje, index) => /*#__PURE__*/_jsxDEV(LiMensaje, {\n          children: [mensaje.usuario, \": \", mensaje.mensaje]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        onChange: e => setNuevoMensaje(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: enviarMensaje,\n        children: \"Enviar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"NO ESTAS CONECTADO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Ingrese su nombre\",\n        onChange: e => setNombreUsuario(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: unirseAlChat,\n        children: \"Unirse al chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"d9yXcdRAE1d9PdYZQkI6f75Xkm0=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["io","useState","useEffect","LiMensaje","UlMensajes","getMessaging","getToken","onMessage","initializeApp","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebaseApp","messaging","Notification","requestPermission","then","permission","console","log","vapidKey","Error","currentToken","catch","err","error","payload","notification","body","data","usuario","mensaje","audio","Audio","play","socket","App","isConnected","setIsConnected","nuevoMensaje","setNuevoMensaje","nombreUsuario","setNombreUsuario","mensajes","setMensajes","on","off","enviarMensaje","emit","token","message","title","firebase","send","unirseAlChat","map","index","e","target","value"],"sources":["C:/Users/Chris/Desktop/ChatBox/frontend/src/App.js"],"sourcesContent":["/* global firebase */\r\n\r\nimport './App.css';\r\nimport { io } from 'socket.io-client';\r\nimport { useState, useEffect } from 'react';\r\nimport { LiMensaje, UlMensajes } from './ui-components';\r\nimport { getMessaging, getToken, onMessage } from \"firebase/messaging\";\r\nimport { initializeApp } from 'firebase/app';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBwBEW-vmdytwra50NwyHaQhYCqg4s_yV4\",\r\n  authDomain: \"chatbox-98fbb.firebaseapp.com\",\r\n  projectId: \"chatbox-98fbb\",\r\n  storageBucket: \"chatbox-98fbb.appspot.com\",\r\n  messagingSenderId: \"314247152483\",\r\n  appId: \"1:314247152483:web:ad1e17c335f01bb6da4956\"\r\n};\r\n\r\nconst firebaseApp = initializeApp(firebaseConfig);\r\nconst messaging = getMessaging(firebaseApp);\r\n\r\n// Solicitar permiso de notificación al cargar la aplicación\r\nNotification.requestPermission().then((permission) => {\r\n  if (permission === 'granted') {\r\n    console.log('Permiso de notificación concedido');\r\n    return getToken(messaging, { vapidKey: '3gjp1GuVkYSZPPsz04fzhOjIoE0PYUYccu3zRlxmMMQ' });\r\n  } else {\r\n    throw new Error('Permiso de notificación denegado');\r\n  }\r\n}).then((currentToken) => {\r\n  if (currentToken) {\r\n    // Send the token to your server and update the UI if necessary\r\n    console.log('Token FCM:', currentToken);\r\n  } else {\r\n    console.log('No registration token available. Request permission to generate one.');\r\n  }\r\n}).catch((err) => {\r\n  console.error('An error occurred while retrieving token. ', err);\r\n});\r\n\r\n// Manejar las notificaciones entrantes\r\nonMessage(messaging, (payload) => {\r\n  console.log('Notificación recibida:', payload);\r\n\r\n  // Mostrar una notificación emergente\r\n  const notification = new Notification('Nuevo mensaje', {\r\n    body: `${payload.data.usuario}: ${payload.data.mensaje}`,\r\n  });\r\n\r\n  // Agregar un sonido de frecuencia grave\r\n  const audio = new Audio('C:\\Users\\Chris\\Desktop\\ChatBox\\frontend\\sonido\\sonidob.mp3'); // Sustituye <URL_DEL_SONIDO> por la URL del archivo de sonido\r\n  audio.play();\r\n  \r\n  // Puedes agregar más lógica aquí según tus necesidades\r\n});\r\n\r\nconst socket = io('http://localhost:3000');\r\n\r\nfunction App() {\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [nuevoMensaje, setNuevoMensaje] = useState('');\r\n  const [nombreUsuario, setNombreUsuario] = useState('');\r\n  const [mensajes, setMensajes] = useState([]);\r\n\r\n  useEffect(() => {\r\n\r\n    socket.on('connectado', () => setIsConnected(true));\r\n\r\n    socket.on('enviar_mensaje', (data) => {\r\n      setMensajes(mensajes => [...mensajes, data]);\r\n    });\r\n\r\n    return () => {\r\n      socket.off('connectado');\r\n      socket.off('enviar_mensaje');\r\n    }\r\n  }, []);\r\n\r\n  const enviarMensaje = () => {\r\n    socket.emit('enviar_mensaje', {\r\n      usuario: nombreUsuario,\r\n      mensaje: nuevoMensaje,\r\n    });\r\n  \r\n    // Enviar notificación usando FCM\r\n    messaging.getToken().then((token) => {\r\n      const message = {\r\n        notification: {\r\n          title: 'Nuevo Mensaje',\r\n          body: `${nombreUsuario}: ${nuevoMensaje}`,\r\n        },\r\n        token: token,\r\n      };\r\n  \r\n      return firebase.messaging().send(message);\r\n    }).catch((error) => {\r\n      console.error('Error al enviar la notificación:', error);\r\n    });\r\n  };\r\n\r\n  const unirseAlChat = () => {\r\n    // Cuando el usuario se une al chat, envía su nombre al servidor\r\n    socket.emit('unirse_al_chat', nombreUsuario);\r\n    setIsConnected(true);\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      {isConnected ? (\r\n        <>\r\n          <h2>SI ESTAS CONECTADO</h2>\r\n          <UlMensajes>\r\n            {mensajes.map((mensaje, index) => (\r\n              <LiMensaje key={index}>{mensaje.usuario}: {mensaje.mensaje}</LiMensaje>\r\n            ))}\r\n          </UlMensajes>\r\n          <input\r\n            type=\"text\"\r\n            onChange={e => setNuevoMensaje(e.target.value)}\r\n          />\r\n          <button onClick={enviarMensaje}>Enviar</button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h2>NO ESTAS CONECTADO</h2>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Ingrese su nombre\"\r\n            onChange={e => setNombreUsuario(e.target.value)}\r\n          />\r\n          <button onClick={unirseAlChat}>Unirse al chat</button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}